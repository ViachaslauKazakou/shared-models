# Scripts –¥–ª—è shared-models

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

## –§–∞–π–ª—ã

### `entrypoint.sh`
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
- –û–∂–∏–¥–∞–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- –í—ã–ø–æ–ª–Ω—è–µ—Ç health check
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –í Docker
./scripts/entrypoint.sh python main.py

# –õ–æ–∫–∞–ª—å–Ω–æ
DB_HOST=localhost ./scripts/entrypoint.sh
```

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `DB_HOST` - —Ö–æ—Å—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: postgres)
- `DB_NAME` - –∏–º—è –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: postgres)
- `DB_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: docker)
- `DB_PASSWORD` - –ø–∞—Ä–æ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: docker)
- `DB_PORT` - –ø–æ—Ä—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5432)

### `check-migration-status.sh`
–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å PostgreSQL
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç pgvector —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/check-migration-status.sh
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Docker

### Docker Compose
–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à `docker-compose.yml`:

```yaml
services:
  app:
    build: .
    depends_on:
      postgres:
        condition: service_healthy
    environment:
      - DATABASE_URL=postgresql+psycopg2://docker:docker@postgres:5432/postgres
    entrypoint: ["./scripts/entrypoint.sh"]
    command: ["python", "main.py"]
```

### –û—Ç–¥–µ–ª—å–Ω—ã–π init-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.migration.yml` –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–∏–≥—Ä–∞—Ü–∏–π.

## CI/CD

### GitHub Actions
```yaml
- name: Run migrations
  run: |
    docker-compose up -d postgres
    ./scripts/entrypoint.sh echo "Migrations applied"
```

### Makefile –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å Makefile:
```bash
make up                 # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç entrypoint.sh –ª–æ–≥–∏–∫—É
make check-migrations   # –í—ã–∑—ã–≤–∞–µ—Ç alembic –∫–æ–º–∞–Ω–¥—ã
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥:
- üü¢ –ó–µ–ª–µ–Ω—ã–π - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- üü° –ñ–µ–ª—Ç—ã–π - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- üî¥ –ö—Ä–∞—Å–Ω—ã–π - –æ—à–∏–±–∫–∏

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π
- –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
